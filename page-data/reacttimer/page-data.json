{"componentChunkName":"component---src-templates-post-template-tsx","path":"/reacttimer/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>로그인 타이머</h2>\n<p>ToyProject에서 일반 로그인을 하면 쿠키에 로그인 정보</p>\n<p>유효 기간을 기본 60분으로 설정해 놨습니다. 예를 들면</p>\n<p>로그인 상태로 브라우저 종료 시에도 60분이 지나야 로그인 쿠키 정보를 삭제합니다.</p>\n<p>쿠키정보는 새로 고침 시 다시 60분으로 초기화 시킵니다.</p>\n<p>이번에 만들어볼 기능은 로그인 상태에서 헤더 부분에 60분 타이머를 보여주고</p>\n<p>타이머 시간이 지나면 자동 로그아웃되면서 로그인 화면으로 바로 이동하는 기능과</p>\n<p>로그인 시간 연장을 할 수 있는 기능을 구현하였습니다.</p>\n<p>코드는 해당 기능 관련 부분만 수정해서 가져왔습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//Header admin.js</span>\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Header</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">props</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>timercheck<span class=\"token punctuation\">,</span> settimercheck<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//카카오 로그인에서는 사용하지 않기 때문에</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">logout</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">await</span> cookie<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token string\">'userid'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">await</span> cookie<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">await</span> cookie<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span><span class=\"token string\">'userpassword'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">await</span> persistor<span class=\"token punctuation\">.</span><span class=\"token function\">purge</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//저장소에 넣어둔 redux정보들 초기화</span>\r\n    window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> <span class=\"token string\">'/login'</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token operator\">&lt;</span>header className<span class=\"token operator\">=</span><span class=\"token string\">\"gnb_box\"</span><span class=\"token operator\">></span>\r\n      <span class=\"token punctuation\">{</span>timercheck <span class=\"token operator\">&amp;&amp;</span> <span class=\"token operator\">&lt;</span>LoginTimer logout<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>logout<span class=\"token punctuation\">}</span> mm<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">60</span><span class=\"token punctuation\">}</span> ss<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">0</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>header<span class=\"token operator\">></span>\r\n  <span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//LoginTimer.js</span>\r\n<span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span>\r\n<span class=\"token keyword\">import</span> cookie <span class=\"token keyword\">from</span> <span class=\"token string\">'react-cookies'</span>\r\n\r\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">LoginTimer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> logout<span class=\"token punctuation\">,</span> mm<span class=\"token punctuation\">,</span> ss <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>minutes<span class=\"token punctuation\">,</span> setMinutes<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>mm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>seconds<span class=\"token punctuation\">,</span> setSeconds<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>ss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">const</span> countdown <span class=\"token operator\">=</span> <span class=\"token function\">setInterval</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>seconds<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token function\">setSeconds</span><span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>seconds<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>seconds<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>minutes<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>countdown<span class=\"token punctuation\">)</span>\r\n          <span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token function\">setMinutes</span><span class=\"token punctuation\">(</span><span class=\"token function\">parseInt</span><span class=\"token punctuation\">(</span>minutes<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n          <span class=\"token function\">setSeconds</span><span class=\"token punctuation\">(</span><span class=\"token number\">59</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">}</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">clearInterval</span><span class=\"token punctuation\">(</span>countdown<span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>minutes<span class=\"token punctuation\">,</span> seconds<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\r\n\r\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">timerInit</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">let</span> cookie_userid <span class=\"token operator\">=</span> cookie<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token string\">'userid'</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">let</span> cookie_usernm <span class=\"token operator\">=</span> cookie<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">let</span> cookie_password <span class=\"token operator\">=</span> cookie<span class=\"token punctuation\">.</span><span class=\"token function\">load</span><span class=\"token punctuation\">(</span><span class=\"token string\">'userpassword'</span><span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token keyword\">const</span> expires <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n    expires<span class=\"token punctuation\">.</span><span class=\"token function\">setMinutes</span><span class=\"token punctuation\">(</span>expires<span class=\"token punctuation\">.</span><span class=\"token function\">getMinutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\r\n\r\n    cookie<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">'userid'</span><span class=\"token punctuation\">,</span> cookie_userid<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> expires <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    cookie<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">,</span> cookie_usernm<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> expires <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    cookie<span class=\"token punctuation\">.</span><span class=\"token function\">save</span><span class=\"token punctuation\">(</span><span class=\"token string\">'userpassword'</span><span class=\"token punctuation\">,</span> cookie_password<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">path</span><span class=\"token operator\">:</span> <span class=\"token string\">'/'</span><span class=\"token punctuation\">,</span> expires <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n    <span class=\"token function\">setMinutes</span><span class=\"token punctuation\">(</span><span class=\"token number\">60</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token function\">setSeconds</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"hd_right\"</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>span<span class=\"token operator\">></span>\r\n          <span class=\"token punctuation\">{</span>minutes<span class=\"token punctuation\">}</span>분<span class=\"token punctuation\">{</span>seconds <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span> <span class=\"token operator\">?</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">0</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>seconds<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">:</span> seconds<span class=\"token punctuation\">}</span>초\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"hd_right\"</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>span onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>timerInit<span class=\"token punctuation\">}</span> style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">cursor</span><span class=\"token operator\">:</span> <span class=\"token string\">'pointer'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\r\n          시간연장\r\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>span<span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\r\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n  <span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span>\r\n\r\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> LoginTimer</code></pre></div>\n<p>prop 값으로는 logout 함수, 분, 초 넘겨주고</p>\n<p>setInterval을 사용하여 1초 간격으로 타이머를 구현하였습니다.</p>\n<p>seconds, minutes가 0을 가리키면 Header admin.js logout() 호출하여</p>\n<p>자동 로그아웃시키고 시간 연장을 누르면 쿠키 유효기간을 60분 추가</p>\n<p>화면에 보여주는 분, 초를 초기화 시켰습니다.</p>\n<h2><img src=\"/386e199957075a0c8ed597bf67cd5dca/NormalOption.png\" alt=\"file:///C:/Reactblog/LEEBLOG/static/react/NormalOption.PNG\"></h2>","frontmatter":{"title":"로그인 타이머","summary":"로그인 타이머 구현하기","date":"2022.03.29.","categories":["React","ToyProject"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQoz2NQwgWUlZWUlZVVVEAMJWWsShhw6VVUkFeQk1WUk1WQk1VSUCBas7KyooKChrGZgU+IhrGZoW+ouoGxIki/MlGaFWSkDXyCTcIT3LrmmkYk6bn5yEtLgt2PXzPIWnlNcyvLtGLnxkk2+TVOjZMsUgo0TMxBlqPqx6ZZXs7QL8w0KsWpcZJjba9jbZ9pVIqBd7CinBwhzTAjzBOybfJqHKq6bQvqzKJTlRQViA0wBTlZHQdX45AYq8xS45A4LWt7BVkZIvwMjShFFXUNTVMLBWkpTTNLZTV1JUVFUuJZUVFBTlZZWUVRVharTnyaQbGqrAJNajgAAIe0an5q22AbAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/cba0b89d2bf2d96a1ed26edb5849f804/07887/reactthumbnail.png","srcSet":"/static/cba0b89d2bf2d96a1ed26edb5849f804/387ef/reactthumbnail.png 300w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/22925/reactthumbnail.png 600w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/07887/reactthumbnail.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/cba0b89d2bf2d96a1ed26edb5849f804/2fedb/reactthumbnail.webp 300w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/4fcbd/reactthumbnail.webp 600w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/0d4d1/reactthumbnail.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":630}},"publicURL":"/static/cba0b89d2bf2d96a1ed26edb5849f804/reactthumbnail.png"}}}}]}},"pageContext":{"slug":"/reacttimer/"}},"staticQueryHashes":[]}