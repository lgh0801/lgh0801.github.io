{"componentChunkName":"component---src-templates-post-template-tsx","path":"/react-quill/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>게시판 에디터</h2>\n<p>ToyProject를 진행하는중에 게시판 글에 에디터기능을 삽입하고자</p>\n<p>에디터 라이브러리인 react-quill를 사용하기로 하였습니다.</p>\n<p>다행히 참고할 자료들이 많아서 어렵지 않게 구현이 가능했습니다.</p>\n<ol>\n<li>react-quill install</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">$ npm install react<span class=\"token operator\">-</span>quill</code></pre></div>\n<p>참고로 게시판을 눌러 상세정보 부분(View)은</p>\n<p>함수형 컴포넌트인 Hook방식을 사용하지않고</p>\n<p>클래스형 컴포넌트를 사용하여 구현하였습니다.</p>\n<p>처음 프로젝트를 공부하고 만들때 클래스형 컴포넌트로 했어가지고…</p>\n<p>다른 부분이나 새로만드는 컴포넌트 부분은 Hook방식으로 다 수정하거나 만들었지만</p>\n<p>View부분은 나중에 시간여유가 많을때</p>\n<p>수정하기로해서 그냥 클래스형 컴포넌트로 진행을 하였습니다.</p>\n<p>아래에서 보여주는 소스는 react-quill를 사용하여</p>\n<p>ToyProject에 적용한 react-quill와 관련된 일부 코드 부분만을</p>\n<p>추출하거나 수정해서 가져온겁니다.</p>\n<p>글을 쓸때와 쓰지않을때 react-quill를 분리했습니다.</p>\n<ol>\n<li>글쓰기 react-quill 코드</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//View.js</span>\r\n<span class=\"token keyword\">import</span> ReactQuill <span class=\"token keyword\">from</span> <span class=\"token string\">'react-quill'</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token string\">'react-quill/dist/quill.snow.css'</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">View</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token comment\">//...</span>\r\n      <span class=\"token literal-property property\">selectedFile</span><span class=\"token operator\">:</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>quillRef <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token function-variable function\">EditorAppend1</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">//이미지 업로드</span>\r\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handlePostImage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">const</span> input <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">)</span>\r\n      input<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'type'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'file'</span><span class=\"token punctuation\">)</span>\r\n      input<span class=\"token punctuation\">.</span><span class=\"token function\">setAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">'accept'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'image/*'</span><span class=\"token punctuation\">)</span>\r\n      input<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n      input<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'change'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">selectedFile</span><span class=\"token operator\">:</span> input<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">const</span> formData <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FormData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n        formData<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'file'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>selectedFile<span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">return</span> axios\r\n          <span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api/upload?type=uploads/image/'</span><span class=\"token punctuation\">,</span> formData<span class=\"token punctuation\">)</span>\r\n          <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">res</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">fileName</span><span class=\"token operator\">:</span> res<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>filename <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">const</span> <span class=\"token constant\">IMG_URL</span> <span class=\"token operator\">=</span> <span class=\"token string\">'/image/'</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>fileName\r\n            <span class=\"token keyword\">const</span> editor <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>quillRef<span class=\"token punctuation\">.</span><span class=\"token function\">getEditor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n            <span class=\"token keyword\">const</span> range <span class=\"token operator\">=</span> editor<span class=\"token punctuation\">.</span><span class=\"token function\">getSelection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 현재 에디터 커서 위치값</span>\r\n            editor<span class=\"token punctuation\">.</span><span class=\"token function\">insertEmbed</span><span class=\"token punctuation\">(</span>range<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">,</span> <span class=\"token string\">'image'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">IMG_URL</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// 가져온 위치에 이미지 삽입</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n          <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">'작업중 오류가 발생하였습니다.'</span><span class=\"token punctuation\">)</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">//quill 에디터</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>modules <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">syntax</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">toolbar</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token literal-property property\">container</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\r\n          <span class=\"token punctuation\">[</span><span class=\"token string\">'link'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'image'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'code-block'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">header</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token punctuation\">[</span><span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'italic'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'underline'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'list'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'blockquote'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token literal-property property\">handlers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token comment\">// 이미지 처리는 직접 handlePostImage라는 함수로 처리</span>\r\n          <span class=\"token literal-property property\">image</span><span class=\"token operator\">:</span> handlePostImage<span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">// 위에서 설정한 모듈들 foramts을 설정</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>formats <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n      <span class=\"token string\">'header'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'italic'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'underline'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'list'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'blockquote'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'image'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'link'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'code-block'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">]</span>\r\n\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n      <span class=\"token operator\">&lt;</span>td key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>before_swtcode<span class=\"token punctuation\">}</span> style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'600px'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>ReactQuill\r\n          ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">ref</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>quillRef <span class=\"token operator\">=</span> ref<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\r\n          style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'600px'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          theme<span class=\"token operator\">=</span><span class=\"token string\">\"snow\"</span>\r\n          value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span>\r\n          onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span>\r\n          modules<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>modules<span class=\"token punctuation\">}</span>\r\n          formats<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>formats<span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ol start=\"2\">\n<li>글을 쓰지않을때 react-quill 코드</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//View.js</span>\r\n<span class=\"token keyword\">import</span> ReactQuill <span class=\"token keyword\">from</span> <span class=\"token string\">'react-quill'</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token string\">'react-quill/dist/quill.snow.css'</span>\r\n\r\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">View</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token comment\">//...</span>\r\n      <span class=\"token literal-property property\">text</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleChange</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>quillRef <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\r\n  <span class=\"token punctuation\">}</span>\r\n  <span class=\"token function-variable function\">EditorAppend2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">//quill 에디터</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>modules <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">syntax</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">toolbar</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">// 위에서 설정한 모듈들 foramts을 설정 list -> strike 변경</span>\r\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>formats <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n      <span class=\"token string\">'header'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'bold'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'italic'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'underline'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'strike'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'blockquote'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'image'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'link'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token string\">'code-block'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">]</span>\r\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\r\n      <span class=\"token operator\">&lt;</span>td key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>before_swtcode<span class=\"token punctuation\">}</span> style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'600px'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\r\n        <span class=\"token operator\">&lt;</span>ReactQuill\r\n          ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token parameter\">ref</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>quillRef <span class=\"token operator\">=</span> ref<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span>\r\n          style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">height</span><span class=\"token operator\">:</span> <span class=\"token string\">'600px'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span>\r\n          readOnly\r\n          theme<span class=\"token operator\">=</span><span class=\"token string\">\"snow\"</span>\r\n          value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">}</span>\r\n          onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleChange<span class=\"token punctuation\">}</span>\r\n          modules<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>modules<span class=\"token punctuation\">}</span>\r\n          formats<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>formats<span class=\"token punctuation\">}</span>\r\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\r\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\r\n    <span class=\"token punctuation\">)</span>\r\n  <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>에디터에서 글쓰기 부분 이미지 업로드처리를 할때</p>\n<p>modules >> handlers >> image 부분에 함수를 넣어서</p>\n<p>따로 작업하였습니다.</p>\n<p>서버쪽은 파일 업로드를 구현하였던 코드를 그대로 사용하였습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">//fileupload.js</span>\r\n<span class=\"token keyword\">const</span> multer <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'multer'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//파일 업로드를 위해 multer 패키지를 불러옵니다.</span>\r\n<span class=\"token keyword\">const</span> moment <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'moment'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">//파일명에 현재 시간을 할당하기위해, 시간 정보를 불러오는 moment 패키지를 불러옵니다.</span>\r\n\r\n<span class=\"token keyword\">const</span> storage <span class=\"token operator\">=</span> multer<span class=\"token punctuation\">.</span><span class=\"token function\">diskStorage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token function-variable function\">destination</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">,</span> cb</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">//파일 저장 경로를 지정하기위해 destination 함수를 싱행합니다.</span>\r\n    <span class=\"token comment\">//이때 파라미터로 react서버에서 전달받은 request와 file정보를 받습니다.</span>\r\n    <span class=\"token comment\">//request에는 텍스트 변수들이, file에는 업로드한 정보가 들어있습니다.</span>\r\n    <span class=\"token comment\">//cb함수는 multer내부적으로 사용되는 함수이니, 정해진 규칙처럼 사용하시면 됩니다.</span>\r\n    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n      <span class=\"token keyword\">var</span> type <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>query<span class=\"token punctuation\">.</span>type <span class=\"token comment\">//react에서 전달받은 type파라미터를, 내부변수 type에 할당합니다.</span>\r\n      <span class=\"token function\">cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">)</span> <span class=\"token comment\">//type에는 폴더 상대경로를 넣어왔는데요. cb함수의 두번째 파라미터로 경로값을 넣습니다.</span>\r\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token function-variable function\">filename</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> file<span class=\"token punctuation\">,</span> cb</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">//저장될 파일명을 지정하기위해 filename함수를 실행합니다.</span>\r\n    <span class=\"token comment\">//이때 파라미터로 react서버에서 전달받은 request와 file정보를 받습니다.</span>\r\n    <span class=\"token function\">cb</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> <span class=\"token function\">moment</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">format</span><span class=\"token punctuation\">(</span><span class=\"token string\">'YYYYMMDDHHmmss'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'_'</span> <span class=\"token operator\">+</span> file<span class=\"token punctuation\">.</span>originalname<span class=\"token punctuation\">)</span>\r\n    <span class=\"token comment\">//cb(null, file.originalname);</span>\r\n    <span class=\"token comment\">//moment함수로 현재시간을 연부터 초까지 추출해, 원본파일명 앞에 붙여줍니다.</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">const</span> upload <span class=\"token operator\">=</span> <span class=\"token function\">multer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">storage</span><span class=\"token operator\">:</span> storage <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">single</span><span class=\"token punctuation\">(</span><span class=\"token string\">'file'</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token comment\">//line4에서 diskStorage함수의 결과로 저장된 storage변수를, multer의 내부 storage변수에 저장합니다.</span>\r\n<span class=\"token comment\">//파일이 하나이니 single('file')함수도 붙여줍니다.</span>\r\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> upload</code></pre></div>","frontmatter":{"title":"게시판 에디터","summary":"react-quill 사용하여 에디터 구현","date":"2022.03.09.","categories":["React"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/ElEQVQoz2NQwgWUlZWUlZVVVEAMJWWsShhw6VVUkFeQk1WUk1WQk1VSUCBas7KyooKChrGZgU+IhrGZoW+ouoGxIki/MlGaFWSkDXyCTcIT3LrmmkYk6bn5yEtLgt2PXzPIWnlNcyvLtGLnxkk2+TVOjZMsUgo0TMxBlqPqx6ZZXs7QL8w0KsWpcZJjba9jbZ9pVIqBd7CinBwhzTAjzBOybfJqHKq6bQvqzKJTlRQViA0wBTlZHQdX45AYq8xS45A4LWt7BVkZIvwMjShFFXUNTVMLBWkpTTNLZTV1JUVFUuJZUVFBTlZZWUVRVharTnyaQbGqrAJNajgAAIe0an5q22AbAAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/cba0b89d2bf2d96a1ed26edb5849f804/07887/reactthumbnail.png","srcSet":"/static/cba0b89d2bf2d96a1ed26edb5849f804/387ef/reactthumbnail.png 300w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/22925/reactthumbnail.png 600w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/07887/reactthumbnail.png 1200w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/cba0b89d2bf2d96a1ed26edb5849f804/2fedb/reactthumbnail.webp 300w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/4fcbd/reactthumbnail.webp 600w,\n/static/cba0b89d2bf2d96a1ed26edb5849f804/0d4d1/reactthumbnail.webp 1200w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":630}},"publicURL":"/static/cba0b89d2bf2d96a1ed26edb5849f804/reactthumbnail.png"}}}}]}},"pageContext":{"slug":"/react-quill/"}},"staticQueryHashes":[]}