{"componentChunkName":"component---src-templates-post-template-tsx","path":"/openaiapi/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2>ChatGpt API 연동해보기</h2>\n<p>여전히 화제를 일으키고 있는 인공지능 챗봇 ChatGpt를</p>\n<p>API로도 사용할수있다고하여 API 연동을해보기로 하였습니다.</p>\n<p>우선 일정 기간 동안은 체험용으로 무료가 있지만 배포하고</p>\n<p>계속 사용하실 거면 유료로 이용을 하셔야 합니다.</p>\n<p>아래 사진은 가격입니다.</p>\n<h2><img src=\"/44039ab02701b108a066f092df70c6cd/price.png\" alt=\"file:///C:/Reactblog/LEEBLOG/static/ai/price.PNG\"></h2>\n<p>위 사진을 보면 아시겠지만 GPT4는 가격이 gpt3.5에비해 10배 이상 비쌉니다.</p>\n<p>저는 물론 배포도 하지 않을 것이고 체험용으로 연동하는 거기 때문에 gpt3.5를 사용하겠습니다.</p>\n<p>일단 제일 처음은 API 키를 발급받으셔야 합니다.</p>\n<h2><img src=\"/2ea35eb42f36c92c0b898448aca21472/createkey.png\" alt=\"file:///C:/Reactblog/LEEBLOG/static/ai/createkey.PNG\"></h2>\n<p>저는 로컬에서만 경험해볼 것이기 때문에 보안이라든지</p>\n<p>디자인 부분(gpt사용)은 신경을 많이 쓰지 않고 기능구현에 집중하였습니다.</p>\n<p>프론트는 html,css,javacript 백엔드는 node.js를 사용하여 구현하였습니다.</p>\n<p>react를 사용할까 하다가 간단한 구현이기 때문에 사용하지 않았습니다.</p>\n<p>이제 본격적으로 시작해보겠습니다.</p>\n<p>openai를 install 해주고</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> openai</code></pre></div>\n<p>그다음으로 node.js에서 사용할 express를 install해줍니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> express</code></pre></div>\n<p>공식문서에서 node.js에서 사용하는 방법을 참조하여 코드를 짜겠습니다.</p>\n<h3>node.js 셋팅 관련 문서</h3>\n<h2><img src=\"/b9146b14d34a240535cc011bbc5b563e/settingexample.png\" alt=\"file:///C:/Reactblog/LEEBLOG/static/ai/settingexample.PNG\"></h2>\n<h3>대화를 생성하는 데 사용되는 함수(Python 예시)</h3>\n<h2><img src=\"/b08fc4f6c44a0abccd105603fe8a0031/settingexample2.png\" alt=\"file:///C:/Reactblog/LEEBLOG/static/ai/settingexample2.PNG\"></h2>\n<p>node.js는 openai.createChatCompletion를 사용하셔야합니다.</p>\n<p>role을 보면 system, user, assistant가있습니다.</p>\n<p>system은 “챗봇이 이해하지 못한 입력” 또는 “일시적으로 문제가 발생하여 대화를 계속할 수 없음”</p>\n<p>등의 메시지가 system 메시지로 처리되고 user는 사용자 채팅 assistant는 답변입니다.</p>\n<h3>API가 응답으로 보내주는 데이터</h3>\n<h2><img src=\"/3b9aa17d06db6eb7a19f4382a66b92a1/settingexample3.png\" alt=\"file:///C:/Reactblog/LEEBLOG/static/ai/settingexample3.PNG\"></h2>\n<h3>구현 화면</h3>\n<h2><img src=\"/35ad3346a41c66ff974c95408a2026e6/chatai.png\" alt=\"file:///C:/Reactblog/LEEBLOG/static/ai/chatai.PNG\"></h2>\n<h3>app.js</h3>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> Configuration<span class=\"token punctuation\">,</span> OpenAIApi <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'openai'</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">const</span> configuration <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Configuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n  <span class=\"token literal-property property\">apiKey</span><span class=\"token operator\">:</span> <span class=\"token string\">'본인 API키'</span><span class=\"token punctuation\">,</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">const</span> openai <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OpenAIApi</span><span class=\"token punctuation\">(</span>configuration<span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">urlencoded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">extended</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span>express<span class=\"token punctuation\">.</span><span class=\"token function\">static</span><span class=\"token punctuation\">(</span>__dirname<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/aiChat'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">{</span> userMessages<span class=\"token punctuation\">,</span> assistantMessages <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">.</span>body\r\n  <span class=\"token keyword\">let</span> messages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\r\n    <span class=\"token punctuation\">{</span>\r\n      <span class=\"token literal-property property\">role</span><span class=\"token operator\">:</span> <span class=\"token string\">'system'</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token literal-property property\">content</span><span class=\"token operator\">:</span> <span class=\"token string\">'일시적으로 문제가 발생하여 대화를 계속할 수 없습니다.'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">]</span>\r\n\r\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>userMessages<span class=\"token punctuation\">.</span>length <span class=\"token operator\">||</span> assistantMessages<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>userMessages<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      messages<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token string\">'{\"role\": \"user\", \"content\": \"'</span> <span class=\"token operator\">+</span> <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>userMessages<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">'\"}'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>assistantMessages<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n      messages<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\r\n        <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>\r\n          <span class=\"token string\">'{\"role\": \"assistant\", \"content\": \"'</span> <span class=\"token operator\">+</span>\r\n            <span class=\"token function\">String</span><span class=\"token punctuation\">(</span>assistantMessages<span class=\"token punctuation\">.</span><span class=\"token function\">shift</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\r\n            <span class=\"token string\">'\"}'</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n      <span class=\"token punctuation\">)</span>\r\n    <span class=\"token punctuation\">}</span>\r\n  <span class=\"token punctuation\">}</span>\r\n\r\n  <span class=\"token comment\">//사용자가 입력한 문장을 기반으로 대화생성</span>\r\n  <span class=\"token keyword\">const</span> completion <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> openai<span class=\"token punctuation\">.</span><span class=\"token function\">createChatCompletion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token literal-property property\">model</span><span class=\"token operator\">:</span> <span class=\"token string\">'gpt-3.5-turbo'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token literal-property property\">messages</span><span class=\"token operator\">:</span> messages<span class=\"token punctuation\">,</span>\r\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n  <span class=\"token keyword\">let</span> assistant <span class=\"token operator\">=</span> completion<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>choices<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>message<span class=\"token punctuation\">[</span><span class=\"token string\">'content'</span><span class=\"token punctuation\">]</span>\r\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">assistant</span><span class=\"token operator\">:</span> assistant <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span></code></pre></div>\n<h3>index.html</h3>\n<p>chatgpt api를 사용하는거니까 디자인을 gpt한테 얻어서 사용하였습니다.</p>\n<p>영화관련해서 채팅UI를 만들어달라고하니까 준 디자인입니다.</p>\n<p>스크립트부분빼고는 손을 대지않았습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>UTF-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>Chat UI Screen<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>style</span><span class=\"token punctuation\">></span></span><span class=\"token style\"><span class=\"token language-css\">\r\n      <span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'Noto Sans KR'</span><span class=\"token punctuation\">,</span> sans-serif<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 14px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> #f8f8f8<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-container</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> 500px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0 auto<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 20px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">background</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> 0px 0px 10px <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 0.1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-box</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> 20px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">overflow-y</span><span class=\"token punctuation\">:</span> scroll<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 300px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> 0px 0px 10px <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 0.1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-message</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">margin-bottom</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">box-shadow</span><span class=\"token punctuation\">:</span> 0px 0px 10px <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>0<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 0<span class=\"token punctuation\">,</span> 0.1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-message p</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">margin</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 0<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #333<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> 600<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-message span</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> 400<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #666<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 12px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">margin-left</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-message.assistant</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #f4f4f4<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-message.assistant p</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #3498db<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-input</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">display</span><span class=\"token punctuation\">:</span> flex<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">margin-top</span><span class=\"token punctuation\">:</span> 20px<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-input input</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">flex</span><span class=\"token punctuation\">:</span> 1<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 5px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">margin-right</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-input button</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #f44336<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">border</span><span class=\"token punctuation\">:</span> none<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">padding</span><span class=\"token punctuation\">:</span> 10px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">border-radius</span><span class=\"token punctuation\">:</span> 5px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">cursor</span><span class=\"token punctuation\">:</span> pointer<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">font-size</span><span class=\"token punctuation\">:</span> 14px<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">font-weight</span><span class=\"token punctuation\">:</span> 600<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">text-transform</span><span class=\"token punctuation\">:</span> uppercase<span class=\"token punctuation\">;</span>\r\n        <span class=\"token property\">transition</span><span class=\"token punctuation\">:</span> background-color 0.3s ease-in-out<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      <span class=\"token selector\">.chat-input button:hover</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #e53935<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n      <span class=\"token selector\">.assistant</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> blue<span class=\"token punctuation\">;</span>\r\n      <span class=\"token punctuation\">}</span>\r\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>style</span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\r\n\r\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>chat-container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>chat-box<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>chat-message<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>assistant<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>영화관련 질문을 해주세요!<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>chat-input<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">placeholder</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>Type your message here...<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\r\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span><span class=\"token punctuation\">></span></span>Send<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\r\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\r\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\r\n      <span class=\"token keyword\">const</span> chatBox <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.chat-box'</span><span class=\"token punctuation\">)</span>\r\n      <span class=\"token keyword\">let</span> userMessages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n      <span class=\"token keyword\">let</span> assistantMessages <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\r\n\r\n      <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sendMessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">const</span> chatInput <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.chat-input input'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token keyword\">const</span> chatMessage <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span>\r\n        chatMessage<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'chat-message'</span><span class=\"token punctuation\">)</span>\r\n        chatMessage<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;p></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chatInput<span class=\"token punctuation\">.</span>value<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/p></span><span class=\"token template-punctuation string\">`</span></span>\r\n        chatBox<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>chatMessage<span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\">//유저 채팅 추가</span>\r\n        userMessages<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>chatInput<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">)</span>\r\n\r\n        chatInput<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">''</span>\r\n\r\n        <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:3000/aiChat'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\r\n          <span class=\"token literal-property property\">method</span><span class=\"token operator\">:</span> <span class=\"token string\">'POST'</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token literal-property property\">headers</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token string-property property\">'Content-Type'</span><span class=\"token operator\">:</span> <span class=\"token string\">'application/json'</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\r\n          <span class=\"token literal-property property\">body</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\r\n            <span class=\"token literal-property property\">userMessages</span><span class=\"token operator\">:</span> userMessages<span class=\"token punctuation\">,</span>\r\n            <span class=\"token literal-property property\">assistantMessages</span><span class=\"token operator\">:</span> assistantMessages<span class=\"token punctuation\">,</span>\r\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\r\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token keyword\">const</span> data <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> response<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token comment\">//GPT 답변 추가</span>\r\n        assistantMessages<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>assistant<span class=\"token punctuation\">)</span>\r\n\r\n        <span class=\"token keyword\">const</span> astrologerMessage <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span>\r\n        astrologerMessage<span class=\"token punctuation\">.</span>classList<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token string\">'chat-message'</span><span class=\"token punctuation\">)</span>\r\n        astrologerMessage<span class=\"token punctuation\">.</span>innerHTML <span class=\"token operator\">=</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;p class='assistant'></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>data<span class=\"token punctuation\">.</span>assistant<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/p></span><span class=\"token template-punctuation string\">`</span></span>\r\n        chatBox<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>astrologerMessage<span class=\"token punctuation\">)</span>\r\n      <span class=\"token punctuation\">}</span>\r\n\r\n      document\r\n        <span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.chat-input button'</span><span class=\"token punctuation\">)</span>\r\n        <span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> sendMessage<span class=\"token punctuation\">)</span>\r\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\r\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\r\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h2>마치면서</h2>\n<p>ChatGpt를 웹사이트에서 사용만 하는 중인데</p>\n<p>API를 연동할 수 있다는 것을 알고는 있었지만 경험하지는 못했었습니다.</p>\n<p>이번에 기회가 되어서 연동을 한번 해보게 되었습니다.</p>\n<p>아이디어가 있다면 충분히 AI API 연동을 이용하여</p>\n<p>여러 가지 서비스를 만들어낼 수 있을 것 같습니다.</p>","frontmatter":{"title":"OpenAI API","summary":"ChatGpt API 연동해보기","date":"2023.08.31.","categories":["AI","Javascript","Node.JS"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAADH0lEQVQozwXBi1PSBwDA8d+ftbvd5vJq87qrvZpe2TwzwwaCigLDfOD7gaSE5AMVBHwSRooTm48tzJzp0mNlp56g4GiSucvdbzjz993nI6T+GhcvTsf41rcrZQ7vkGvfJP/+BhrTOhW1z6m/s0Bb0RxdeVO4Mn14vxpl6nM3Tz5zsJJiZ+Ocg71zdt6m2vn3Qj/CtemImO3fRTa2J+UPR1E7o+hse5Tf26amcZ3mikXMJT/TJZ/Ale3Bm+4mcLmXYFonv5+38jrVQjSllcNPWkh+3Iyg8G2LKm8EtWdfKh74kx/731DZ9xc11j2aTBuYqpex6GboVj3CJRthLMvJ4wwbT7+2snapjc00I7Hzdbz7tILkRzoE5cC2WOiOoHJEJcNQnGpnnLL7UeruhWmoC2GuWqJLP0N/0TijilH8MhfzOT0sfW9lPd3E1pe1xNJKOfpCSzJFiXCzMyrmWvcod8Ykz3yCyWCCvuFdGo0hBnpfYTMEcZQEGFE9ZFw5wmO5k+DtHlYLbGyoO4ioLRzoLBylazi5JEfIaE6IOS37dHjj0oNAnIGxXSb8YR55NgkM/sHiww2CfSss9yyxZl/kZf8Cm445troneeOdY7/VyfshH0dZKk4ybyNcqzoUr9+J0jkUl8an43i8EQL+HXzul0w511mf3SY0+YrwwjY70yEi48+JjT/jYOoZR9MLHDo8/DPo4ThPzqksB+GG7p14S7OP3hCWHPZdfJ4I7fXLmLQzDLXM86ApwLxthgl9P4v1g6yW2dg0dBMztHOgb+C4+S7JpnpOivL4oLyKIMs/FPOVUQoVryWt/AVl8kVqFLO0KP20yUewFThxqbrwFVuZVZtZ1baxpTUR1zXyt74aUavhP90PfCjN5qz0GwRF9lux4EaYkpyQVHrzNypz56m99RPGPC/tCje9ql6Gizvw6yw8KTOzVtnKTtVdDmqMvK+tI9lQxmlzIWfGLCTjRYTCKwmx+MoWmu9WJH36L5RnTFJ1dZSG607MOTb65B141BYCpWae1rYRMrYSMZtIWFs47mgg2VXJqU3NWU8Wku0C/wMk9XiOWiERBQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/8464c/openaithumbnail.png","srcSet":"/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/822a9/openaithumbnail.png 350w,\n/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/66634/openaithumbnail.png 700w,\n/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/8464c/openaithumbnail.png 1400w","sizes":"(min-width: 1400px) 1400px, 100vw"},"sources":[{"srcSet":"/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/e5908/openaithumbnail.webp 350w,\n/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/23874/openaithumbnail.webp 700w,\n/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/4c08a/openaithumbnail.webp 1400w","type":"image/webp","sizes":"(min-width: 1400px) 1400px, 100vw"}]},"width":1400,"height":788}},"publicURL":"/static/5f7e6b555bbf8e51fae2fc6ea71c5a70/openaithumbnail.png"}}}}]}},"pageContext":{"slug":"/openaiapi/"}},"staticQueryHashes":[]}